steps:
- name: 'mirror.gcr.io/library/golang'
  args: ['go', 'version']
- name: 'mirror.gcr.io/library/golang'
  args: ['go', 'test']
  dir: 'functions/generatepopulation'
- name: 'gcr.io/cloud-builders/gcloud'
  args:
    - functions
    - deploy
    - --runtime=go113
    - --trigger-http
    - --source=./functions/generatepopulation # Function source files
    - --entry-point=GeneratePopulation # Function entry point
    - --region=europe-west1
    - --allow-unauthenticated # This function is publicly available 
    - generatepopulation # Function name
  waitFor: ['-']
  id: 'generatepopulation'